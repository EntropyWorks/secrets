function formInit(){function t(){var t=document.getElementById("text").value,e=document.getElementById("time").value,n=document.getElementById("pin").value;API.send(e,t,n,function(t){var e=location.protocol+"//"+location.host+"/show/"+t.key,n=document.getElementById("result__info");n.value=e,n.focus(),n.select()})}function e(){var t=document.getElementById("pin").value,e=location.pathname.replace("/show/","");API.get(e,t,function(t){var e=document.getElementById("result__info");document.getElementById("result__tip").textContent="Here is your info:",e.value=t.message,e.focus(),e.select()},function(){var t=document.getElementById("result__tip");t.classList.add("result__tip_error"),t.textContent="Sorry, but your PIN is wrong."})}new FForm(document.getElementById("fs-form"),{onReview:location.pathname.indexOf("show")>0?e:t})}function getCharCode(t){return t.which?t.which:t.keyCode}function isButtonNumber(t){return!(t<48||t>57)}function pinCheck(t){var e=getCharCode(t);if(!isButtonNumber(e)||t.target.value+1>API.params.pin_size)return void t.preventDefault()}function numberCheck(t){var e=getCharCode(t);if(!isButtonNumber(e))return void t.preventDefault()}function numInputsInit(){for(var t=document.querySelectorAll(".input_type_pin"),e=document.querySelectorAll(".input_type_number"),n=t.length-1;n>=0;n--)t[n].addEventListener("keypress",pinCheck);for(var n=e.length-1;n>=0;n--)e[n].addEventListener("keypress",numberCheck)}window.Modernizr=function(t,e,n){function r(t){_.cssText=t}function i(t,e){return typeof t===e}function s(t,e){return!!~(""+t).indexOf(e)}function o(t,e){for(var r in t){var i=t[r];if(!s(i,"-")&&_[i]!==n)return"pfx"!=e||i}return!1}function a(t,e,r){for(var s in t){var o=e[t[s]];if(o!==n)return r===!1?t[s]:i(o,"function")?o.bind(r||e):o}return!1}function c(t,e,n){var r=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+E.join(r+" ")+r).split(" ");return i(e,"string")||i(e,"undefined")?o(s,e):(s=(t+" "+w.join(r+" ")+r).split(" "),a(s,e,n))}var l,u,d,p="2.8.3",f={},h=!0,m=e.documentElement,v="modernizr",y=e.createElement(v),_=y.style,g=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),N="Webkit Moz O ms",E=N.split(" "),w=N.toLowerCase().split(" "),C={},S=[],b=S.slice,L=function(t,n,r,i){var s,o,a,c,l=e.createElement("div"),u=e.body,d=u||e.createElement("body");if(parseInt(r,10))for(;r--;)a=e.createElement("div"),a.id=i?i[r]:v+(r+1),l.appendChild(a);return s=["&#173;",'<style id="s',v,'">',t,"</style>"].join(""),l.id=v,(u?l:d).innerHTML+=s,d.appendChild(l),u||(d.style.background="",d.style.overflow="hidden",c=m.style.overflow,m.style.overflow="hidden",m.appendChild(d)),o=n(l,t),u?l.parentNode.removeChild(l):(d.parentNode.removeChild(d),m.style.overflow=c),!!o},x={}.hasOwnProperty;d=i(x,"undefined")||i(x.call,"undefined")?function(t,e){return e in t&&i(t.constructor.prototype[e],"undefined")}:function(t,e){return x.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var n=b.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=e.prototype;var s=new i,o=e.apply(s,n.concat(b.call(arguments)));return Object(o)===o?o:s}return e.apply(t,n.concat(b.call(arguments)))};return r}),C.cssanimations=function(){return c("animationName")};for(var F in C)d(C,F)&&(u=F.toLowerCase(),f[u]=C[F](),S.push((f[u]?"":"no-")+u));return f.addTest=function(t,e){if("object"==typeof t)for(var r in t)d(t,r)&&f.addTest(r,t[r]);else{if(t=t.toLowerCase(),f[t]!==n)return f;e="function"==typeof e?e():e,"undefined"!=typeof h&&h&&(m.className+=" "+(e?"":"no-")+t),f[t]=e}return f},r(""),y=l=null,function(t,e){function n(t,e){var n=t.createElement("p"),r=t.getElementsByTagName("head")[0]||t.documentElement;return n.innerHTML="x<style>"+e+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var t=_.elements;return"string"==typeof t?t.split(" "):t}function i(t){var e=y[t[m]];return e||(e={},v++,t[m]=v,y[v]=e),e}function s(t,n,r){if(n||(n=e),u)return n.createElement(t);r||(r=i(n));var s;return s=r.cache[t]?r.cache[t].cloneNode():h.test(t)?(r.cache[t]=r.createElem(t)).cloneNode():r.createElem(t),!s.canHaveChildren||f.test(t)||s.tagUrn?s:r.frag.appendChild(s)}function o(t,n){if(t||(t=e),u)return t.createDocumentFragment();n=n||i(t);for(var s=n.frag.cloneNode(),o=0,a=r(),c=a.length;o<c;o++)s.createElement(a[o]);return s}function a(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(n){return _.shivMethods?s(n,t,e):e.createElem(n)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(_,e.frag)}function c(t){t||(t=e);var r=i(t);return _.shivCSS&&!l&&!r.hasCSS&&(r.hasCSS=!!n(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||a(t,r),t}var l,u,d="3.7.0",p=t.html5||{},f=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,h=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",v=0,y={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",l="hidden"in t,u=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(n){l=!0,u=!0}}();var _={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:d,shivCSS:p.shivCSS!==!1,supportsUnknownElements:u,shivMethods:p.shivMethods!==!1,type:"default",shivDocument:c,createElement:s,createDocumentFragment:o};t.html5=_,c(e)}(this,e),f._version=p,f._prefixes=g,f._domPrefixes=w,f._cssomPrefixes=E,f.testProp=function(t){return o([t])},f.testAllProps=c,f.testStyles=L,f.prefixed=function(t,e,n){return e?c(t,e,n):c(t,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(h?" js "+S.join(" "):""),f}(this,this.document),function(t,e,n){function r(t){return"[object Function]"==v.call(t)}function i(t){return"string"==typeof t}function s(){}function o(t){return!t||"loaded"==t||"complete"==t||"uninitialized"==t}function a(){var t=y.shift();_=1,t?t.t?h(function(){("c"==t.t?p.injectCss:p.injectJs)(t.s,0,t.a,t.x,t.e,1)},0):(t(),a()):_=0}function c(t,n,r,i,s,c,l){function u(e){if(!f&&o(d.readyState)&&(g.r=f=1,!_&&a(),d.onload=d.onreadystatechange=null,e)){"img"!=t&&h(function(){E.removeChild(d)},50);for(var r in L[n])L[n].hasOwnProperty(r)&&L[n][r].onload()}}var l=l||p.errorTimeout,d=e.createElement(t),f=0,v=0,g={t:r,s:n,e:s,a:c,x:l};1===L[n]&&(v=1,L[n]=[]),"object"==t?d.data=n:(d.src=n,d.type=t),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){u.call(this,v)},y.splice(i,0,g),"img"!=t&&(v||2===L[n]?(E.insertBefore(d,N?null:m),h(u,l)):L[n].push(d))}function l(t,e,n,r,s){return _=0,e=e||"j",i(t)?c("c"==e?C:w,t,e,this.i++,n,r,s):(y.splice(this.i++,0,t),1==y.length&&a()),this}function u(){var t=p;return t.loader={load:l,i:0},t}var d,p,f=e.documentElement,h=t.setTimeout,m=e.getElementsByTagName("script")[0],v={}.toString,y=[],_=0,g="MozAppearance"in f.style,N=g&&!!e.createRange().compareNode,E=N?f:m.parentNode,f=t.opera&&"[object Opera]"==v.call(t.opera),f=!!e.attachEvent&&!f,w=g?"object":f?"script":"img",C=f?"script":w,S=Array.isArray||function(t){return"[object Array]"==v.call(t)},b=[],L={},x={timeout:function(t,e){return e.length&&(t.timeout=e[0]),t}};p=function(t){function e(t){var e,n,r,t=t.split("!"),i=b.length,s=t.pop(),o=t.length,s={url:s,origUrl:s,prefixes:t};for(n=0;n<o;n++)r=t[n].split("="),(e=x[r.shift()])&&(s=e(s,r));for(n=0;n<i;n++)s=b[n](s);return s}function o(t,i,s,o,a){var c=e(t),l=c.autoCallback;c.url.split(".").pop().split("?").shift(),c.bypass||(i&&(i=r(i)?i:i[t]||i[o]||i[t.split("/").pop().split("?")[0]]),c.instead?c.instead(t,i,s,o,a):(L[c.url]?c.noexec=!0:L[c.url]=1,s.load(c.url,c.forceCSS||!c.forceJS&&"css"==c.url.split(".").pop().split("?").shift()?"c":n,c.noexec,c.attrs,c.timeout),(r(i)||r(l))&&s.load(function(){u(),i&&i(c.origUrl,a,o),l&&l(c.origUrl,a,o),L[c.url]=2})))}function a(t,e){function n(t,n){if(t){if(i(t))n||(d=function(){var t=[].slice.call(arguments);p.apply(this,t),f()}),o(t,d,e,0,l);else if(Object(t)===t)for(c in a=function(){var e,n=0;for(e in t)t.hasOwnProperty(e)&&n++;return n}(),t)t.hasOwnProperty(c)&&(!n&&!--a&&(r(d)?d=function(){var t=[].slice.call(arguments);p.apply(this,t),f()}:d[c]=function(t){return function(){var e=[].slice.call(arguments);t&&t.apply(this,e),f()}}(p[c])),o(t[c],d,e,c,l))}else!n&&f()}var a,c,l=!!t.test,u=t.load||t.both,d=t.callback||s,p=d,f=t.complete||s;n(l?t.yep:t.nope,!!u),u&&n(u)}var c,l,d=this.yepnope.loader;if(i(t))o(t,0,d,0);else if(S(t))for(c=0;c<t.length;c++)l=t[c],i(l)?o(l,0,d,0):S(l)?p(l):Object(l)===l&&a(l,d);else Object(t)===t&&a(t,d)},p.addPrefix=function(t,e){x[t]=e},p.addFilter=function(t){b.push(t)},p.errorTimeout=1e4,null==e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",d=function(){e.removeEventListener("DOMContentLoaded",d,0),e.readyState="complete"},0)),t.yepnope=u(),t.yepnope.executeStack=a,t.yepnope.injectJs=function(t,n,r,i,c,l){var u,d,f=e.createElement("script"),i=i||p.errorTimeout;f.src=t;for(d in r)f.setAttribute(d,r[d]);n=l?a:n||s,f.onreadystatechange=f.onload=function(){!u&&o(f.readyState)&&(u=1,n(),f.onload=f.onreadystatechange=null)},h(function(){u||(u=1,n(1))},i),c?f.onload():m.parentNode.insertBefore(f,m)},t.yepnope.injectCss=function(t,n,r,i,o,c){var l,i=e.createElement("link"),n=c?a:n||s;i.href=t,i.rel="stylesheet",i.type="text/css";for(l in r)i.setAttribute(l,r[l]);o||(m.parentNode.insertBefore(i,m),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("csscalc",function(){var t="width:",e="calc(10px);",n=document.createElement("div");return n.style.cssText=t+Modernizr._prefixes.join(e+t),!!n.style.length}),Modernizr.addTest("cssvhunit",function(){var t;return Modernizr.testStyles("#modernizr { height: 50vh; }",function(e,n){var r=parseInt(window.innerHeight/2,10),i=parseInt((window.getComputedStyle?getComputedStyle(e,null):e.currentStyle).height,10);t=i==r}),t});var API=function(){var t=this,e="https://safesecret.info/api/v1/",n=e+"message",r=e+"params";return this.send=function(t,e,r,i){var s=new XMLHttpRequest,o=JSON.stringify({exp:60*new Number(t),message:new String(e),pin:new String(r)});s.open("POST",n,!0),s.onreadystatechange=function(){4==s.readyState&&"function"==typeof i&&201==s.status&&i(JSON.parse(s.responseText))},s.send(o)},this.get=function(t,e,r,i){var s=new XMLHttpRequest;s.open("GET",[n,t,e].join("/"),!0),s.onreadystatechange=function(){4==s.readyState&&"function"==typeof r&&(200==s.status?r(JSON.parse(s.responseText)):i())},s.send()},this._getParams=function(){var e=new XMLHttpRequest;e.open("GET",r,!0),e.onreadystatechange=function(){4==e.readyState&&200==e.status&&(t.params=JSON.parse(e.responseText))},e.send()},this.params={pin_size:5,max_pin_attempts:3,max_exp_sec:86400},this._getParams(),this}();!function(t){"use strict";function e(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function n(t,e){var n=r(t,e)?s:i;n(t,e)}var r,i,s;"classList"in document.documentElement?(r=function(t,e){return t.classList.contains(e)},i=function(t,e){for(var n=[].concat(e.split(" ")),r=n.length-1;r>=0;r--)t.classList.add(n[r])},s=function(t,e){t.classList.remove(e)}):(r=function(t,n){return e(n).test(t.className)},i=function(t,e){r(t,e)||(t.className=t.className+" "+e)},s=function(t,n){t.className=t.className.replace(e(n)," ")});var o={hasClass:r,addClass:i,removeClass:s,toggleClass:n,has:r,add:i,remove:s,toggle:n};"function"==typeof define&&define.amd?define(o):t.classie=o}(window),function(t){"use strict";function e(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function n(t,e){var n=document.createElement(t);return e&&(e.cName&&(n.className=e.cName),e.inner&&(n.innerHTML=e.inner),e.appendTo&&e.appendTo.appendChild(n)),n}function r(t,n){this.el=t,this.options=e({},this.options),e(this.options,n),this._init()}var i={animations:Modernizr.cssanimations},s={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},o=s[Modernizr.prefixed("animation")];r.prototype.options={ctrlProgress:!0,ctrlNavDots:!0,ctrlNavPosition:!0,onReview:function(){return!1}},r.prototype._init=function(){this.formEl=this.el.querySelector(".fs-form__content"),this.fieldsList=this.formEl.querySelector("ol.fields"),this.current=0,this.fields=[].slice.call(this.fieldsList.children),this.fieldsCount=this.fields.length,classie.add(this.fields[this.current],"field field_current"),this._addControls(),this._addErrorMsg(),this._initEvents()},r.prototype._addControls=function(){if(this.ctrls=n("div",{cName:"controls",appendTo:this.el}),this.ctrlContinue=n("button",{cName:"continue",inner:"Continue",appendTo:this.ctrls}),this._showCtrl(this.ctrlContinue),this.options.ctrlNavDots){this.ctrlNav=n("nav",{cName:"nav-dots",appendTo:this.ctrls});for(var t="",e=0;e<this.fieldsCount;++e)t+=e===this.current?'<button class="nav-dots__item nav-dots__item_current"></button>':'<button class="nav-dots__item" disabled></button>';this.ctrlNav.innerHTML=t,this._showCtrl(this.ctrlNav),this.ctrlNavDots=[].slice.call(this.ctrlNav.children)}this.options.ctrlNavPosition&&(this.ctrlFldStatus=n("span",{cName:"numbers",appendTo:this.ctrls}),this.ctrlFldStatusCurr=n("span",{cName:"numbers__item numbers__item_current",inner:Number(this.current+1)}),this.ctrlFldStatus.appendChild(this.ctrlFldStatusCurr),this.ctrlFldStatusTotal=n("span",{cName:"numbers__item",inner:this.fieldsCount}),this.ctrlFldStatus.appendChild(this.ctrlFldStatusTotal),this._showCtrl(this.ctrlFldStatus)),this.options.ctrlProgress&&(this.ctrlProgress=n("div",{cName:"progress",appendTo:this.ctrls}),this._showCtrl(this.ctrlProgress))},r.prototype._addErrorMsg=function(){this.msgError=n("span",{cName:"error",appendTo:this.el})},r.prototype._initEvents=function(){var t=this;this.ctrlContinue.addEventListener("click",function(){t._nextField()}),this.options.ctrlNavDots&&this.ctrlNavDots.forEach(function(e,n){e.addEventListener("click",function(){t._showField(n)})}),document.addEventListener("keydown",function(e){if(!t.isLastStep){var n=e.keyCode||e.which,r=e.target.tagName.toLowerCase(),i=e.metaKey||e.ctrlKey;13===n&&("textarea"!==r||"textarea"===r&&i)&&(e.preventDefault(),t._nextField())}})},r.prototype._nextField=function(t){if(this.isLastStep||!this._validade()||this.isAnimating)return!1;this.isAnimating=!0,this.isLastStep=this.current===this.fieldsCount-1&&void 0===t,this._clearError();var e=this.fields[this.current];if(this.navdir=void 0!==t&&t<this.current?"prev":"next",this.current=void 0!==t?t:this.current+1,void 0===t&&(this._progress(),this.farthest=this.current),classie.add(this.fieldsList,"fields fields_"+this.navdir),classie.remove(e,"field_current"),classie.add(e,"field_hide"),!this.isLastStep){this._updateNav(),this._updateFieldNumber();var n=this.fields[this.current];classie.add(n,"field_current"),classie.add(n,"field_shown")}var r=this,s=function(t){i.animations&&this.removeEventListener(o,s),classie.remove(r.fieldsList,"fields_"+r.navdir),classie.remove(e,"field_hide"),r.isLastStep?(r._hideCtrl(r.ctrlNav),r._hideCtrl(r.ctrlProgress),r._hideCtrl(r.ctrlContinue),r._hideCtrl(r.ctrlFldStatus),classie.remove(r.formEl,"fs-form__content_full"),classie.add(r.formEl,"fs-form__content_overview"),classie.add(r.formEl,"form__content_shown"),r.options.onReview()):(classie.remove(n,"field_shown"),r.options.ctrlNavPosition&&(r.ctrlFldStatusCurr.innerHTML=r.ctrlFldStatusNew.innerHTML,r.ctrlFldStatus.removeChild(r.ctrlFldStatusNew),classie.remove(r.ctrlFldStatus,"numbers_shown-"+r.navdir)),n.querySelectorAll(".input, .textarea")[0].focus()),r.isAnimating=!1};i.animations?"next"===this.navdir?this.isLastStep?e.querySelector(".animation__upper").addEventListener(o,s):n.querySelector(".animation__lower").addEventListener(o,s):n.querySelector(".animation__upper").addEventListener(o,s):s()},r.prototype._showField=function(t){return!(t===this.current||t<0||t>this.fieldsCount-1)&&void this._nextField(t)},r.prototype._updateFieldNumber=function(){if(this.options.ctrlNavPosition){this.ctrlFldStatusNew=document.createElement("span"),this.ctrlFldStatusNew.className="numbers__item numbers__item_new",this.ctrlFldStatusNew.innerHTML=Number(this.current+1),this.ctrlFldStatus.appendChild(this.ctrlFldStatusNew);var t=this;setTimeout(function(){classie.add(t.ctrlFldStatus,"next"===t.navdir?"numbers_shown-next":"numbers_shown-prev")},25)}},r.prototype._progress=function(){this.options.ctrlProgress&&(this.ctrlProgress.style.width=this.current*(100/this.fieldsCount)+"%")},r.prototype._updateNav=function(){this.options.ctrlNavDots&&(classie.remove(this.ctrlNav.querySelector("button.nav-dots__item_current"),"nav-dots__item_current"),classie.add(this.ctrlNavDots[this.current],"nav-dots__item_current"),this.ctrlNavDots[this.current].disabled=!1)},r.prototype._showCtrl=function(t){classie.add(t,"shown")},r.prototype._hideCtrl=function(t){classie.remove(t,"shown")},r.prototype._validade=function(){var t,e=this.fields[this.current],n=e.querySelector(".input[required]")||e.querySelector(".textarea[required]");if(!n)return!0;if(0==n.value.length)t="NOVAL";else if(n.classList.contains("input_type_number")){var r=new Number(n.value),i=Math.floor(API.params.max_exp_sec/60);"-"==n.value.substr(0,1)?t="NONEG":n.value!=r.toString()?t="WRONGVAL":r>i&&(t="MAXNUM")}else n.classList.contains("input_type_pin")&&(n.value.match(/^[0-9]{5}$/)||(t="WRONGVAL"));return void 0==t||(this._showError(t),!1)},r.prototype._showError=function(t){var e="";switch(t){case"NOVAL":e="Please fill the field before continuing";break;case"NONEG":e="This value can't be negative";break;case"WRONGVAL":e="Please enter the valid value";break;case"MAXNUM":e="Maximum keeping time is "+Math.floor(API.params.max_exp_sec/60)+" minutes"}this.msgError.innerHTML=e,this._showCtrl(this.msgError)},r.prototype._clearError=function(){this._hideCtrl(this.msgError)},t.FForm=r}(window),"loading"!=document.readyState?formInit():document.addEventListener("DOMContentLoaded",formInit),"loading"!=document.readyState?numInputsInit():document.addEventListener("DOMContentLoaded",numInputsInit);